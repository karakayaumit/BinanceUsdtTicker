<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <script src="https://s3.tradingview.com/tv.js"></script>
</head>
<body style="margin:0">
<div id="tv_chart_container" style="width:100%;height:100vh;"></div>
<script>
const params = new URLSearchParams(location.search);
const symbol = (params.get('symbol') || 'BTCUSDT').toUpperCase();
const interval = (params.get('interval') || '1m').toLowerCase();

// TradingView'de Binance USDT vadeli işlemler için sembol formatı
// BTCUSDT -> BTCUSDTPERP
const tvSymbol = symbol.endsWith('USDT')
  ? symbol.replace('USDT', 'USDTPERP')
  : symbol;

const intervalMap = {
    '1m': '1',
    '5m': '5',
    '15m': '15',
    '1h': '60',
    '4h': '240',
    '1d': '1D'
};

new TradingView.widget({
    autosize: true,
    container_id: 'tv_chart_container',
    // Vadeli sembolü kullan
    symbol: 'BINANCE:' + tvSymbol,
    interval: intervalMap[interval] || '1',
    timezone: 'Etc/UTC',
    theme: 'light',
    style: '1',
    locale: 'en',
    toolbar_bg: '#f1f3f6',
    hide_side_toolbar: false,
    withdateranges: true,
    allow_symbol_change: false
});
</script>
</body>
</html>
